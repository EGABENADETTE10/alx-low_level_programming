C-more functions,more nested looops
